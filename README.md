# Super Dragon's Lair Arcade (SNES)

![Complete Package](schwag/complete_package.png)

**Super Dragon's Lair Arcade** is a full-motion-video (FMV) retheme of RoadBlaster for the Super Nintendo Entertainment System, targeting real NTSC SNES hardware with MSU-1 audio/video on SD2SNES/FXPAK Pro.

This faithful recreation of the 1983 arcade classic brings the legendary laserdisc adventure to your SNES console, complete with authentic packaging and documentation reminiscent of the 16-bit era.

## What's in the Box

Your complete Super Dragon's Lair Arcade package includes:

- **Game Cartridge** - The SNES ROM with MSU-1 enhancement chip support
- **User Manual** - Complete 4-page instruction booklet with story, controls, and survival guide
- **Holographic Trading Card** - Collectible card featuring Dirk the Daring
- **Soundtrack CD** - Original arcade audio tracks in CD quality
- **Sticker Sheet** - Dragon's Lair themed stickers
- **Warranty Card** - Official product registration
- **Upcoming Releases Preview** - Sneak peek at future titles

> [!NOTE]
> All schwag materials are available in the [`schwag/`](schwag) directory for your enjoyment and nostalgia.

## Recent milestones
- **Build System Enhanced (Nov 2024):**
  - âœ… **WLA-DX Assembler Built** - Successfully compiled wla-65816, wla-spc700, and wlalink for WSL
  - âœ… **Superfamiconv Integration** - ~100Ã— faster builds via `USE_SUPERFAMICONV=1` environment variable
  - âœ… **Pre-Build Validation** - `check_image_dimensions.py` catches asset errors in 1 second
  - âœ… **Enhanced Make Clean** - Now removes Python cache; `clean-all` target for deep cleaning
  - âœ… **Build Documentation** - Comprehensive `BUILD.md` with troubleshooting guide
- **Graphics Pipeline Modernized:**
  - Created `img_processor.py` for image resizing/quantization to SNES resolutions (256Ã—224, color reduction)
  - Created `gfx_converter.py` unified wrapper for `superfamiconv` and `gracon.py` with consistent output naming
  - Integrated `superfamiconv` (~100Ã— faster than gracon.py) for rapid asset conversion
  - Processed first Dragon's Lair background (high score screen) with full documentation
  - All background and sprite description files converted to Dragon's Lair theme
- **Asset Documentation Complete:**
  - All 9 background folders now have Dragon's Lair themed `.txt` description files
  - All 16 sprite descriptions updated to medieval fantasy theme
  - Legacy RoadBlaster sprites clearly marked (brake, dashboard, steering wheels, turbo)
  - Created workflow guides for future asset processing
- **Python 3 Compatibility:** All tools modernized; `gracon.py` performance issues resolved
- **Script Flow Documentation:** Boot/title/score/MSU1 flow documented in `src/README.md`
- **Chapter Coverage:** 516 chapters tracked; 0 markers unmapped (captured in `data/chapter_event_inventory.md`)

## Scope and goals
- Recreate the Dragon's Lair arcade experience on the SNES while retaining the RoadBlaster MSU-1 FMV engine
- Replace all RoadBlaster assets with Dragon's Lair equivalents (video, audio, sprites, UI, prompts) while preserving arcade timings and cues
- Produce a fully playable SNES ROM plus MSU-1 PCM/data set for real hardware

## Build at a glance

### Requirements
- **OS:** Linux/WSL (Ubuntu) or Windows with WSL
- **Build Tools:** `make`, `gcc` (for WLA-DX, pre-built binaries included)
- **Python:** Python 3.10+ with Pillow
  ```bash
  # WSL/Ubuntu
  sudo apt-get install python3-pip python3-pil
  
  # Or via pip
  pip install -r requirements.txt
  ```

### Quick Build (Standard)
```bash
# From Windows PowerShell with WSL
wsl bash -c "cd /mnt/e/gh/SNES-SuperDragonsLairArcade && make clean && make"

# Or from WSL directly
make clean
make
```

### Fast Build (Superfamiconv - Recommended)
```bash
# Windows: Use the batch file
build_with_superfamiconv.bat

# WSL: Set environment variable
USE_SUPERFAMICONV=1 make
```
**Speed:** ~100Ã— faster graphics conversion (1 sec vs 96 sec per large image)

### Pre-Build Validation (Recommended)
Catch asset errors before building:
```bash
# Quick dimension check (1 second)
wsl python3 tests/check_image_dimensions.py

# Full validation with conversion test (~5 minutes)
wsl python3 tests/test_background_assets.py
```

**Output:** ROM binary at `build/SuperDragonsLairArcade.sfc`

> [!NOTE]
> MSU-1 PCM/data files are not generated by default; they require Dragon's Lair video/audio captures.

**See [`BUILD.md`](BUILD.md) for detailed build instructions and troubleshooting.**

## Asset pipeline status

### Graphics Tools âœ… Complete
- **img_processor.py** - Resize/crop/quantize images to SNES specs (256Ã—224, color limits)
- **gfx_converter.py** - Unified interface for superfamiconv or gracon.py
- **superfamiconv** - High-speed C++ converter (~100Ã— faster than gracon)
- **Workflow documented** - See `tools/README.md` and `data/backgrounds/hiscore.gfx_bg/README.md`

### Background Assets ğŸ”„ In Progress
| Background | Status | Notes |
| --- | --- | --- |
| High Score | âœ… Processed | First complete example with full workflow |
| Title Screen | ğŸ“ Ready | Description file ready for generation |
| Score Entry | ğŸ“ Ready | Description file ready for generation |
| Level Complete (Ã—3) | ğŸ“ Ready | Description files ready for generation |
| Logo | ğŸ“ Ready | Description file ready for generation |
| MSU1 Placeholder | ğŸ“ Ready | Description file ready for generation |
| HUD Overlay | ğŸ“ Ready | Description file ready (8bpp direct color) |

**Process:** Use `img_processor.py` to prepare artwork â†’ build system auto-converts via `animationWriter.py`

### Sprite Assets ğŸ“ Descriptions Ready
All sprite descriptions updated to Dragon's Lair theme:
- **Directional arrows** (up/down/left/right) - Glowing cyan fantasy cues
- **Impact effects** (bang) - Sword strikes, magical sparkles
- **Life system** (heart/helmet icons, numerals)
- **Score popups** (normal/extra points with golden glow)
- **Bonus indicators** ("PERFECT!" celebration text)

**Legacy sprites marked:** brake, dashboard, steering wheels, turbo (not used in Dragon's Lair)

### Sound Assets âœ… Audited & Registered
- **Kept:** `ok`, `shuriken`, `technique`, `turn` (generic/action cues)
- **New:** `dragon_roar` (ambient/boss), `sword_clank` (impact)
- **Legacy:** `brake`, `turbo` (marked as unused)
- **System:** Updated `spcinterface.h` to register new sounds; documentation in `data/sounds/README.md`

### FMV/Audio â³ Awaiting Source Material
- Chapter scripts exist in `data/events/` (516 chapters)
- Frame conversion ready (`gracon.py`, `animationWriter.py`)
- MSU-1 packaging ready (`msu1blockwriter.py`)
- **Needs:** Dragon's Lair video captures and audio tracks

## Documentation map
- `README.md` (this file) â€“ Project overview and status
- **[`BUILD.md`](BUILD.md)** â€“ **Build instructions, troubleshooting, and validation**
- `src/README.md` â€“ Boot/title/score/MSU1 script flow and theming
- `tools/README.md` â€“ Complete graphics tools documentation and workflows
- `data/backgrounds/*/README.md` â€“ Background-specific guides (see hiscore.gfx_bg)
- `data/backgrounds/README.md` â€“ Background asset status
- `data/sprites/README.md` â€“ Sprite inventory and descriptions
- `data/sounds/README.md` â€“ Sound system and asset documentation
- `data/events/README.md` â€“ Chapter XML reference
- `data/chapter_event_inventory.md` â€“ Event coverage tracking

## Hardware targets
- NTSC Super Nintendo hardware
- SD2SNES / FXPAK Pro (MSU-1 required)
- SNES9x / bsnes for debugging and iteration

## Next steps

### Immediate (Graphics)
1. **Generate background artwork** from description files in `data/backgrounds/*/`
2. **Process with img_processor.py** to 256Ã—224, 16 colors
3. **Run make** - build system handles conversion automatically
4. **Test in emulator** to verify appearance

### Next Phase (Sprites)
1. Generate Dragon's Lair themed sprites from updated descriptions
2. Replace existing RoadBlaster placeholder sprites
3. Remove legacy sprites (brake, dashboard, steering wheels, turbo)

### Future (FMV/Audio)
1. Extract Dragon's Lair arcade video frames
2. Extract and normalize Dragon's Lair audio tracks
3. Process with `xmlsceneparser.py` â†’ converters â†’ `msu1blockwriter.py`
4. Package MSU-1 data files for distribution

## Graphics Workflow Quick Reference

```bash
# Step 1: Prepare artwork (resize + quantize to 16 colors)
python tools/img_processor.py \
  --input source_artwork.png \
  --output data/backgrounds/name.gfx_bg/name.gfx_bg.png \
  --width 256 --height 224 --mode cover --colors 16

# Step 2: Build (automatic conversion)
make

# Output: build/data/backgrounds/name.gfx_bg.animation
```

See `tools/README.md` for detailed documentation.

## License
This project includes no commercial Dragon's Lair assets. All extracted assets must be supplied by the user. This repository contains engine code and converter tools only.
