# Super Dragon's Lair Arcade (SNES)

Super Dragon's Lair Arcade is a full-motion-video (FMV) retheme of RoadBlaster for the Super Nintendo Entertainment System, targeting real NTSC SNES hardware with MSU-1 audio/video on SD2SNES/FXPAK Pro.

## Recent milestones
- **Graphics Pipeline Modernized (Nov 2024):**
  - Created `img_processor.py` for image resizing/quantization to SNES resolutions (256√ó224, color reduction)
  - Created `gfx_converter.py` unified wrapper for `superfamiconv` and `gracon.py` with consistent output naming
  - Integrated `superfamiconv` (~100√ó faster than gracon.py) for rapid asset conversion
  - Processed first Dragon's Lair background (high score screen) with full documentation
  - All background and sprite description files converted to Dragon's Lair theme
- **Asset Documentation Complete:**
  - All 9 background folders now have Dragon's Lair themed `.txt` description files
  - All 16 sprite descriptions updated to medieval fantasy theme
  - Legacy RoadBlaster sprites clearly marked (brake, dashboard, steering wheels, turbo)
  - Created workflow guides for future asset processing
- **Python 3 Compatibility:** All tools modernized; `gracon.py` performance issues resolved
- **Script Flow Documentation:** Boot/title/score/MSU1 flow documented in `src/README.md`
- **Chapter Coverage:** 516 chapters tracked; 0 markers unmapped (captured in `data/chapter_event_inventory.md`)

## Scope and goals
- Recreate the Dragon's Lair arcade experience on the SNES while retaining the RoadBlaster MSU-1 FMV engine
- Replace all RoadBlaster assets with Dragon's Lair equivalents (video, audio, sprites, UI, prompts) while preserving arcade timings and cues
- Produce a fully playable SNES ROM plus MSU-1 PCM/data set for real hardware

## Build at a glance
**Requirements:** Linux/WSL or Windows, `make`, WLA-DX 9.5a, Python 3 with Pillow (`pip install -r requirements.txt`)

**Quick build:**
```bash
make clean
make
```
Outputs land in `build/`. The ROM binary is `build/SuperDragonsLairArcade.sfc`. MSU-1 PCM/data files are not generated by default; they require Dragon's Lair video/audio captures.

## Asset pipeline status

### Graphics Tools ‚úÖ Complete
- **img_processor.py** - Resize/crop/quantize images to SNES specs (256√ó224, color limits)
- **gfx_converter.py** - Unified interface for superfamiconv or gracon.py
- **superfamiconv** - High-speed C++ converter (~100√ó faster than gracon)
- **Workflow documented** - See `tools/README.md` and `data/backgrounds/hiscore.gfx_bg/README.md`

### Background Assets üîÑ In Progress
| Background | Status | Notes |
| --- | --- | --- |
| High Score | ‚úÖ Processed | First complete example with full workflow |
| Title Screen | üìù Ready | Description file ready for generation |
| Score Entry | üìù Ready | Description file ready for generation |
| Level Complete (√ó3) | üìù Ready | Description files ready for generation |
| Logo | üìù Ready | Description file ready for generation |
| MSU1 Placeholder | üìù Ready | Description file ready for generation |
| HUD Overlay | üìù Ready | Description file ready (8bpp direct color) |

**Process:** Use `img_processor.py` to prepare artwork ‚Üí build system auto-converts via `animationWriter.py`

### Sprite Assets üìù Descriptions Ready
All sprite descriptions updated to Dragon's Lair theme:
- **Directional arrows** (up/down/left/right) - Glowing cyan fantasy cues
- **Impact effects** (bang) - Sword strikes, magical sparkles
- **Life system** (heart/helmet icons, numerals)
- **Score popups** (normal/extra points with golden glow)
- **Bonus indicators** ("PERFECT!" celebration text)

**Legacy sprites marked:** brake, dashboard, steering wheels, turbo (not used in Dragon's Lair)

### Sound Assets ‚úÖ Audited & Registered
- **Kept:** `ok`, `shuriken`, `technique`, `turn` (generic/action cues)
- **New:** `dragon_roar` (ambient/boss), `sword_clank` (impact)
- **Legacy:** `brake`, `turbo` (marked as unused)
- **System:** Updated `spcinterface.h` to register new sounds; documentation in `data/sounds/README.md`

### FMV/Audio ‚è≥ Awaiting Source Material
- Chapter scripts exist in `data/events/` (516 chapters)
- Frame conversion ready (`gracon.py`, `animationWriter.py`)
- MSU-1 packaging ready (`msu1blockwriter.py`)
- **Needs:** Dragon's Lair video captures and audio tracks

## Documentation map
- `README.md` (this file) ‚Äì Project overview and status
- `src/README.md` ‚Äì Boot/title/score/MSU1 script flow and theming
- `tools/README.md` ‚Äì Complete graphics tools documentation and workflows
- `data/backgrounds/*/README.md` ‚Äì Background-specific guides (see hiscore.gfx_bg)
- `data/backgrounds/README.md` ‚Äì Background asset status
- `data/sprites/README.md` ‚Äì Sprite inventory and descriptions
- `data/events/README.md` ‚Äì Chapter XML reference
- `data/chapter_event_inventory.md` ‚Äì Event coverage tracking

## Hardware targets
- NTSC Super Nintendo hardware
- SD2SNES / FXPAK Pro (MSU-1 required)
- SNES9x / bsnes for debugging and iteration

## Next steps

### Immediate (Graphics)
1. **Generate background artwork** from description files in `data/backgrounds/*/`
2. **Process with img_processor.py** to 256√ó224, 16 colors
3. **Run make** - build system handles conversion automatically
4. **Test in emulator** to verify appearance

### Next Phase (Sprites)
1. Generate Dragon's Lair themed sprites from updated descriptions
2. Replace existing RoadBlaster placeholder sprites
3. Remove legacy sprites (brake, dashboard, steering wheels, turbo)

### Future (FMV/Audio)
1. Extract Dragon's Lair arcade video frames
2. Extract and normalize Dragon's Lair audio tracks
3. Process with `xmlsceneparser.py` ‚Üí converters ‚Üí `msu1blockwriter.py`
4. Package MSU-1 data files for distribution

## Graphics Workflow Quick Reference

```bash
# Step 1: Prepare artwork (resize + quantize to 16 colors)
python tools/img_processor.py \
  --input source_artwork.png \
  --output data/backgrounds/name.gfx_bg/name.gfx_bg.png \
  --width 256 --height 224 --mode cover --colors 16

# Step 2: Build (automatic conversion)
make

# Output: build/data/backgrounds/name.gfx_bg.animation
```

See `tools/README.md` for detailed documentation.

## License
This project includes no commercial Dragon's Lair assets. All extracted assets must be supplied by the user. This repository contains engine code and converter tools only.
